{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vohra\\\\OneDrive\\\\Desktop\\\\ass3-master (1)\\\\ass3-master - Copy\\\\frontend\\\\src\\\\views\\\\MyBooking.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport BCard from '../components/BCard';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MyBooking() {\n  _s();\n\n  const name = localStorage.getItem('name');\n  const token = localStorage.getItem('token');\n  const [bookings, setbookings] = useState([]);\n  const [fetchTrigger, setfetchTrigger] = useState(0);\n  const [data, setdata] = useState({});\n  useEffect(() => {\n    const fn = async () => {\n      try {\n        let res = await axios.get(`http://localhost:5005/bookings`, {\n          headers: {\n            authorization: 'Bearer ' + token\n          }\n        });\n\n        if (res.status === 200) {\n          console.log(res.data.bookings);\n          let dd = {};\n          let ll = [];\n          await Promise.all(res.data.bookings.map(async (e, i) => {\n            let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\n\n            if (res.status === 200) {\n              if (res.data.listing.owner === name) {\n                dd[e.listingId] = res.data.listing;\n                ll.push(e);\n              }\n            }\n          }));\n          setdata({ ...dd\n          });\n          setbookings([...ll]);\n        }\n      } catch (e) {\n        var _e$response, _e$response$data;\n\n        console.error(e);\n        alert(e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error);\n      }\n    };\n\n    fn();\n  }, [fetchTrigger]);\n\n  const handleAccept = async bookingId => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`, {}, {\n        headers: {\n          authorization: 'Bearer ' + token\n        }\n      });\n\n      if (res.status === 200) {\n        setfetchTrigger(fetchTrigger + 1);\n      }\n    } catch (e) {\n      var _e$response2, _e$response2$data;\n\n      console.log(e);\n      alert(e === null || e === void 0 ? void 0 : (_e$response2 = e.response) === null || _e$response2 === void 0 ? void 0 : (_e$response2$data = _e$response2.data) === null || _e$response2$data === void 0 ? void 0 : _e$response2$data.error);\n    }\n  };\n\n  const handleDecline = async bookingId => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`, {}, {\n        headers: {\n          authorization: 'Bearer ' + token\n        }\n      });\n\n      if (res.status === 200) {\n        setfetchTrigger(fetchTrigger + 1);\n      }\n    } catch (e) {\n      var _e$response3, _e$response3$data;\n\n      console.log(e);\n      alert(e === null || e === void 0 ? void 0 : (_e$response3 = e.response) === null || _e$response3 === void 0 ? void 0 : (_e$response3$data = _e$response3.data) === null || _e$response3$data === void 0 ? void 0 : _e$response3$data.error);\n    }\n  };\n\n  const handleDelete = async bookingId => {\n    try {\n      let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`, {}, {\n        headers: {\n          authorization: 'Bearer ' + token\n        }\n      });\n\n      if (res.status === 200) {\n        setfetchTrigger(fetchTrigger + 1);\n      }\n    } catch (e) {\n      var _e$response4, _e$response4$data;\n\n      console.log(e);\n      alert(e === null || e === void 0 ? void 0 : (_e$response4 = e.response) === null || _e$response4 === void 0 ? void 0 : (_e$response4$data = _e$response4.data) === null || _e$response4$data === void 0 ? void 0 : _e$response4$data.error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"100px\"\n    },\n    children: bookings.map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(BCard, {\n        booking: e,\n        data: data,\n        handleAccept: handleAccept,\n        handleDecline: handleDecline,\n        handleDelete: handleDelete\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 97,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyBooking, \"hB9eLqpU21RWF1eNueGh2fQiqws=\");\n\n_c = MyBooking;\nexport default MyBooking;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyBooking\");","map":{"version":3,"sources":["C:/Users/vohra/OneDrive/Desktop/ass3-master (1)/ass3-master - Copy/frontend/src/views/MyBooking.js"],"names":["React","useState","useEffect","BCard","axios","MyBooking","name","localStorage","getItem","token","bookings","setbookings","fetchTrigger","setfetchTrigger","data","setdata","fn","res","get","headers","authorization","status","console","log","dd","ll","Promise","all","map","e","i","listingId","listing","owner","push","error","alert","response","handleAccept","bookingId","put","handleDecline","handleDelete","delete","marginTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport BCard from '../components/BCard'\r\nimport axios from 'axios';\r\n\r\nfunction MyBooking() {\r\n    const name = localStorage.getItem('name')\r\n    const token = localStorage.getItem('token');\r\n    const [bookings, setbookings] = useState([]);\r\n    const [fetchTrigger, setfetchTrigger] = useState(0);\r\n    const [data, setdata] = useState({});\r\n\r\n    useEffect(() => {\r\n        const fn = async () => {\r\n            try {\r\n                let res = await axios.get(`http://localhost:5005/bookings`, {\r\n                    headers: {\r\n                        authorization: 'Bearer ' + token\r\n                    }\r\n                })\r\n                if (res.status === 200) {\r\n                    console.log(res.data.bookings);\r\n                    let dd = {}\r\n                    let ll=[]\r\n                    await Promise.all(res.data.bookings.map(async (e, i) => {\r\n                        let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\r\n                        if (res.status === 200) {\r\n                            if (res.data.listing.owner === name) {\r\n                                dd[e.listingId] = res.data.listing;\r\n                                ll.push(e);\r\n                            }\r\n                        }\r\n                    }));\r\n                    setdata({...dd})\r\n                    setbookings([...ll]);\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error(e);\r\n                alert(e?.response?.data?.error);\r\n            }\r\n        }\r\n        fn();\r\n    }, [fetchTrigger])\r\n\r\n    const handleAccept = async (bookingId) => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`, {}, {\r\n                headers: {\r\n                    authorization: 'Bearer ' + token\r\n                }\r\n            });\r\n            if (res.status === 200) {\r\n                setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e?.response?.data?.error);\r\n        }\r\n    }\r\n\r\n    const handleDecline = async (bookingId) => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`,{}, {\r\n                headers: {\r\n                    authorization: 'Bearer ' + token\r\n                }\r\n            });\r\n            if (res.status === 200) {\r\n                setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e?.response?.data?.error);\r\n        }\r\n    }\r\n\r\n    const handleDelete = async (bookingId) => {\r\n        try {\r\n            let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`,{},\r\n                {\r\n                    headers: {\r\n                        authorization: 'Bearer ' + token\r\n                    }\r\n                }\r\n            );\r\n            if (res.status === 200) {\r\n                setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e?.response?.data?.error);\r\n        }\r\n    }\r\n\r\n    return (\r\n\r\n        <div style={{ marginTop: \"100px\" }}>\r\n            {bookings.map((e, i) => {\r\n                return (<BCard key={i} booking={e} data={data} handleAccept={handleAccept} handleDecline={handleDecline} handleDelete={handleDelete} />)\r\n            })}\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default MyBooking\r\n"]},"metadata":{},"sourceType":"module"}