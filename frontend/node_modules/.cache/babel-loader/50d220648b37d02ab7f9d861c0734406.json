{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vohra\\\\OneDrive\\\\Desktop\\\\ass3-master (1)\\\\ass3-master\\\\frontend\\\\src\\\\views\\\\MyBooking.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport BCard from '../components/BCard';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MyBooking() {\n  _s();\n\n  const token = localStorage.getItem('token');\n  const [bookings, setbookings] = useState([]);\n  const [fetchTrigger, setfetchTrigger] = useState(0);\n  const [data, setdata] = useState({});\n  useEffect(() => {\n    const fn = async () => {\n      try {\n        let res = await axios.get(`http://localhost:5005/bookings`, {\n          headers: {\n            authorization: 'Bearer ' + token\n          }\n        });\n\n        if (res.status === 200) {\n          console.log(res.data.bookings);\n          setbookings([...res.data.bookings]);\n        }\n      } catch (e) {\n        var _e$response, _e$response$data;\n\n        console.error(e);\n        alert(e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error);\n      }\n    };\n\n    fn();\n  }, [fetchTrigger]);\n\n  const handleAccept = async () => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  const handleDecline = async () => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  const handleDelete = async () => {\n    try {\n      let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  useEffect(() => {\n    const fn = async () => {\n      let dd = {};\n      await Promise.all(bookings.map(async (e, i) => {\n        let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\n\n        if (res.status === 200) {\n          dd[e.id] = res.data.listing;\n        }\n      }));\n      setdata({ ...dd\n      });\n    };\n\n    fn();\n  }, [bookings]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"100px\"\n    },\n    children: bookings.map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(BCard, {\n        booking: e,\n        data: data\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 22\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyBooking, \"yADD8GY1XgVK0xFo3X6wZzUvXDQ=\");\n\n_c = MyBooking;\nexport default MyBooking;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyBooking\");","map":{"version":3,"sources":["C:/Users/vohra/OneDrive/Desktop/ass3-master (1)/ass3-master/frontend/src/views/MyBooking.js"],"names":["React","useState","useEffect","BCard","axios","MyBooking","token","localStorage","getItem","bookings","setbookings","fetchTrigger","setfetchTrigger","data","setdata","fn","res","get","headers","authorization","status","console","log","e","error","alert","response","handleAccept","put","bookingId","handleDecline","handleDelete","delete","dd","Promise","all","map","i","listingId","id","listing","marginTop"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport BCard from '../components/BCard'\r\nimport axios from 'axios';\r\n\r\nfunction MyBooking() {\r\n    const token = localStorage.getItem('token');\r\n    const [bookings, setbookings] = useState([]);\r\n    const [fetchTrigger, setfetchTrigger] = useState(0);\r\n    const [data, setdata] = useState({});\r\n\r\n    useEffect(() => {\r\n        const fn = async () => {\r\n            try {\r\n                let res = await axios.get(`http://localhost:5005/bookings`,{\r\n                    headers: {\r\n                        authorization: 'Bearer ' + token\r\n                    }\r\n                })\r\n                if(res.status=== 200) {\r\n                    console.log(res.data.bookings)\r\n                    setbookings([...res.data.bookings])\r\n                }\r\n\r\n            } catch(e) {\r\n                console.error(e);\r\n                alert(e?.response?.data?.error);\r\n            }\r\n        }\r\n        fn();\r\n    }, [fetchTrigger])\r\n\r\n    const handleAccept = async() => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`);\r\n            if(res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        }catch(e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    const handleDecline = async() => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`);\r\n            if(res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        }catch(e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    const handleDelete = async() => {\r\n        try {\r\n            let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`);\r\n            if(res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        }catch(e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const fn = async() =>{\r\n          let dd = {}\r\n          await Promise.all(bookings.map(async (e, i)=>{\r\n            let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\r\n            if(res.status === 200){\r\n              dd[e.id] = res.data.listing;\r\n            }\r\n          }))\r\n          setdata({...dd});\r\n    \r\n        }\r\n        fn();\r\n      }, [bookings])\r\n\r\n    return (\r\n        \r\n        <div style={{marginTop:\"100px\"}}>\r\n            {bookings.map((e, i)=>{\r\n              return(<BCard key={i} booking={e} data={data}/>)})}\r\n        </div>\r\n        \r\n    )\r\n}\r\n\r\nexport default MyBooking\r\n"]},"metadata":{},"sourceType":"module"}