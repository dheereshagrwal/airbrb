{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vohra\\\\OneDrive\\\\Desktop\\\\ass3-master (1)\\\\ass3-master\\\\frontend\\\\src\\\\views\\\\MyListings.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Card from '../components/Card';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst name = localStorage.getItem('name');\n\nfunction MyListings() {\n  _s();\n\n  const [listings, setlistings] = useState([]);\n  const [data, setdata] = useState([]);\n  const [fetchTrigger, setfetchTrigger] = useState(0);\n\n  const handleDelete = async id => {\n    try {\n      let res = await axios.delete(`http://localhost:5005/listings/${id}`, {\n        headers: {\n          authorization: 'Bearer ' + token\n        }\n      });\n\n      if (res.status == 200) {\n        setfetchTrigger(fetchTrigger + 1);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(err.response.data.error);\n    }\n  };\n\n  useEffect(() => {\n    const fn = async () => {\n      let resp = await axios.get(`http://localhost:5005/listings`);\n\n      if (resp.status === 200) {\n        let ls = [];\n        console.log(name);\n\n        for (let i = 0; i < resp.data.listings.length; i++) {\n          if (resp.data.listings[i].owner === name) {\n            ls.push(resp.data.listings[i]);\n          }\n        }\n\n        console.log(resp.data.listings);\n        console.log(ls);\n        setlistings([...ls]);\n      }\n    };\n\n    fn();\n  }, [fetchTrigger]);\n  useEffect(() => {\n    const fn = async () => {\n      let dd = [];\n      await Promise.all(listings.map(async (e, i) => {\n        let res = await axios.get(`http://localhost:5005/listings/${e.id}`);\n\n        if (res.status === 200) {\n          dd.push(res.data.listing);\n          dd[i].id = e.id;\n        }\n      }));\n      setdata([...dd]);\n    };\n\n    fn();\n  }, [listings]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"100px\"\n    },\n    children: listings.map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(Card, {\n        data: { ...e,\n          control: 2\n        },\n        handleDelete: handleDelete\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 22\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyListings, \"IFqlOtSSKY+5+s7XS8m8JOuDWAU=\");\n\n_c = MyListings;\nexport default MyListings;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyListings\");","map":{"version":3,"sources":["C:/Users/vohra/OneDrive/Desktop/ass3-master (1)/ass3-master/frontend/src/views/MyListings.js"],"names":["React","useState","useEffect","Card","axios","name","localStorage","getItem","MyListings","listings","setlistings","data","setdata","fetchTrigger","setfetchTrigger","handleDelete","id","res","delete","headers","authorization","token","status","err","console","error","alert","response","fn","resp","get","ls","log","i","length","owner","push","dd","Promise","all","map","e","listing","marginTop","control"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport Card from '../components/Card';\r\nimport axios from 'axios';\r\n\r\nconst name = localStorage.getItem('name');\r\n\r\nfunction MyListings() {\r\n  const [listings, setlistings] = useState([]);\r\n  const [data, setdata] = useState([]);\r\n  const [fetchTrigger, setfetchTrigger] = useState(0);\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      let res = await axios.delete(`http://localhost:5005/listings/${id}`, {\r\n        headers: {\r\n          authorization: 'Bearer ' + token\r\n        }\r\n      });\r\n      if(res.status==200){\r\n        setfetchTrigger(fetchTrigger+1);\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(err.response.data.error);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fn = async() => {\r\n      let resp = await axios.get(`http://localhost:5005/listings`);\r\n      if(resp.status === 200){\r\n        let ls = [];\r\n        console.log(name)\r\n        for(let i=0; i<resp.data.listings.length; i++){\r\n            if(resp.data.listings[i].owner===name){\r\n                ls.push(resp.data.listings[i]);\r\n            }\r\n            \r\n        }\r\n        console.log(resp.data.listings)\r\n        console.log(ls);\r\n        setlistings([...ls]);\r\n      }\r\n    }\r\n    fn();\r\n  }, [fetchTrigger])\r\n\r\n  useEffect(() => {\r\n    const fn = async() =>{\r\n      let dd = []\r\n      await Promise.all(listings.map(async (e, i)=>{\r\n        let res = await axios.get(`http://localhost:5005/listings/${e.id}`);\r\n        if(res.status === 200){\r\n          dd.push(res.data.listing);\r\n          dd[i].id = e.id;\r\n        }\r\n      }))\r\n      setdata([...dd]);\r\n    }\r\n    fn();\r\n  }, [listings])\r\n\r\n\r\n    return (\r\n        <div style={{marginTop:\"100px\"}}>\r\n            {listings.map((e, i)=>{\r\n              return(<Card key={i} data={{...e, control:2}} handleDelete={handleDelete}/>)})}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MyListings\r\n"]},"metadata":{},"sourceType":"module"}