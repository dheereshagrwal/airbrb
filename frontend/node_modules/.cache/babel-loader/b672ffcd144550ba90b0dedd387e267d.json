{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vohra\\\\OneDrive\\\\Desktop\\\\ass3-master (1)\\\\ass3-master\\\\frontend\\\\src\\\\views\\\\MyListings.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Card from '../components/Card';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst name = localStorage.getItem('name');\nconst token = localStorage.getItem('token');\n\nfunction MyListings() {\n  _s();\n\n  const [listings, setlistings] = useState([]);\n  const [data, setdata] = useState({});\n  const [fetchTrigger, setfetchTrigger] = useState(0);\n\n  const handleDelete = async id => {\n    try {\n      console.log(id);\n      let res = await axios.delete(`http://localhost:5005/listings/${id}`, {\n        headers: {\n          authorization: 'Bearer ' + token\n        }\n      });\n\n      if (res.status == 200) {\n        setfetchTrigger(fetchTrigger + 1);\n      }\n    } catch (err) {\n      console.error(err);\n      alert(JSON.stringify(err));\n    }\n  };\n\n  useEffect(() => {\n    const fn = async () => {\n      let resp = await axios.get(`http://localhost:5005/listings`);\n\n      if (resp.status === 200) {\n        let ls = [];\n        console.log(name);\n\n        for (let i = 0; i < resp.data.listings.length; i++) {\n          if (resp.data.listings[i].owner === name) {\n            ls.push(resp.data.listings[i]);\n          }\n        }\n\n        console.log(resp.data.listings);\n        console.log(ls);\n        setlistings([...ls]);\n      }\n    };\n\n    fn();\n  }, [fetchTrigger]);\n  useEffect(() => {\n    const fn = async () => {\n      let dd = {};\n      await Promise.all(listings.map(async (e, i) => {\n        let res = await axios.get(`http://localhost:5005/listings/${e.id}`);\n\n        if (res.status === 200) {\n          dd[e.id] = res.data.listing;\n        }\n      }));\n      setdata({ ...dd\n      });\n    };\n\n    fn();\n  }, [listings]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"100px\"\n    },\n    children: listings.map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(Card, {\n        data: { ...e,\n          control: 2\n        },\n        handleDelete: handleDelete,\n        ob: data,\n        fetchTrigger: fetchTrigger,\n        setfetchTrigger: setfetchTrigger\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 22\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyListings, \"fowjTasBRbMizj4cM/0Bbw27N3Q=\");\n\n_c = MyListings;\nexport default MyListings;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyListings\");","map":{"version":3,"sources":["C:/Users/vohra/OneDrive/Desktop/ass3-master (1)/ass3-master/frontend/src/views/MyListings.js"],"names":["React","useState","useEffect","Card","axios","name","localStorage","getItem","token","MyListings","listings","setlistings","data","setdata","fetchTrigger","setfetchTrigger","handleDelete","id","console","log","res","delete","headers","authorization","status","err","error","alert","JSON","stringify","fn","resp","get","ls","i","length","owner","push","dd","Promise","all","map","e","listing","marginTop","control"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport Card from '../components/Card';\r\nimport axios from 'axios';\r\n\r\nconst name = localStorage.getItem('name');\r\nconst token = localStorage.getItem('token');\r\n\r\nfunction MyListings() {\r\n  const [listings, setlistings] = useState([]);\r\n  const [data, setdata] = useState({});\r\n  const [fetchTrigger, setfetchTrigger] = useState(0);\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      console.log(id)\r\n      let res = await axios.delete(`http://localhost:5005/listings/${id}`, {\r\n        headers: {\r\n          authorization: 'Bearer ' + token\r\n        }\r\n      });\r\n      if(res.status==200){\r\n        setfetchTrigger(fetchTrigger+1);\r\n      }\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(JSON.stringify(err));\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fn = async() => {\r\n      let resp = await axios.get(`http://localhost:5005/listings`);\r\n      if(resp.status === 200){\r\n        let ls = [];\r\n        console.log(name)\r\n        for(let i=0; i<resp.data.listings.length; i++){\r\n            if(resp.data.listings[i].owner===name){\r\n                ls.push(resp.data.listings[i]);\r\n            }\r\n            \r\n        }\r\n        console.log(resp.data.listings)\r\n        console.log(ls);\r\n        setlistings([...ls]);\r\n      }\r\n    }\r\n    fn();\r\n  }, [fetchTrigger])\r\n\r\n  useEffect(() => {\r\n    const fn = async() =>{\r\n      let dd = {}\r\n      await Promise.all(listings.map(async (e, i)=>{\r\n        let res = await axios.get(`http://localhost:5005/listings/${e.id}`);\r\n        if(res.status === 200){\r\n          dd[e.id] = res.data.listing;\r\n        }\r\n      }))\r\n      setdata({...dd});\r\n\r\n    }\r\n    fn();\r\n  }, [listings])\r\n\r\n\r\n    return (\r\n        <div style={{marginTop:\"100px\"}}>\r\n            {listings.map((e, i)=>{\r\n              return(<Card key={i} data={{...e, control:2}} handleDelete={handleDelete} ob={data} fetchTrigger={fetchTrigger} setfetchTrigger={setfetchTrigger}/>)})}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MyListings\r\n"]},"metadata":{},"sourceType":"module"}