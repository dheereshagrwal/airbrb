{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\vohra\\\\OneDrive\\\\Desktop\\\\ass3-master (1)\\\\ass3-master\\\\frontend\\\\src\\\\views\\\\MyBooking.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport BCard from '../components/BCard';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction MyBooking() {\n  _s();\n\n  const name = localStorage.getItem('name');\n  const token = localStorage.getItem('token');\n  const [bookings, setbookings] = useState([]);\n  const [fetchTrigger, setfetchTrigger] = useState(0);\n  const [data, setdata] = useState({});\n  useEffect(() => {\n    const fn = async () => {\n      try {\n        let res = await axios.get(`http://localhost:5005/bookings`, {\n          headers: {\n            authorization: 'Bearer ' + token\n          }\n        });\n\n        if (res.status === 200) {\n          console.log(res.data.bookings);\n          let dd = {};\n          let ll = [];\n          await Promise.all(res.data.bookings.map(async (e, i) => {\n            let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\n\n            if (res.status === 200) {\n              if (res.data.listing.owner === name) {\n                dd[e.listingId] = res.data.listing;\n                ll.push(e);\n              }\n            }\n          }));\n          setdata({ ...dd\n          });\n          setbookings([...ll]);\n        }\n      } catch (e) {\n        var _e$response, _e$response$data;\n\n        console.error(e);\n        alert(e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error);\n      }\n    };\n\n    fn();\n  }, [fetchTrigger]);\n\n  const handleAccept = async () => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  const handleDecline = async () => {\n    try {\n      let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  const handleDelete = async () => {\n    try {\n      let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`);\n\n      if (res.status === 200) {// setfetchTrigger(fetchTrigger+1);\n      }\n    } catch (e) {\n      console.log(e);\n      alert(e.response.data.error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginTop: \"100px\"\n    },\n    children: Object.key(data).map((e, i) => {\n      return /*#__PURE__*/_jsxDEV(BCard, {\n        booking: e,\n        data: data\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 25\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyBooking, \"hB9eLqpU21RWF1eNueGh2fQiqws=\");\n\n_c = MyBooking;\nexport default MyBooking;\n\nvar _c;\n\n$RefreshReg$(_c, \"MyBooking\");","map":{"version":3,"sources":["C:/Users/vohra/OneDrive/Desktop/ass3-master (1)/ass3-master/frontend/src/views/MyBooking.js"],"names":["React","useState","useEffect","BCard","axios","MyBooking","name","localStorage","getItem","token","bookings","setbookings","fetchTrigger","setfetchTrigger","data","setdata","fn","res","get","headers","authorization","status","console","log","dd","ll","Promise","all","map","e","i","listingId","listing","owner","push","error","alert","response","handleAccept","put","bookingId","handleDecline","handleDelete","delete","marginTop","Object","key"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,qBAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAEA,SAASC,SAAT,GAAqB;AAAA;;AACjB,QAAMC,IAAI,GAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAb;AACA,QAAMC,KAAK,GAAGF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACA,QAAM,CAACE,QAAD,EAAWC,WAAX,IAA0BV,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACW,YAAD,EAAeC,eAAf,IAAkCZ,QAAQ,CAAC,CAAD,CAAhD;AACA,QAAM,CAACa,IAAD,EAAOC,OAAP,IAAkBd,QAAQ,CAAC,EAAD,CAAhC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMc,EAAE,GAAG,YAAY;AACnB,UAAI;AACA,YAAIC,GAAG,GAAG,MAAMb,KAAK,CAACc,GAAN,CAAW,gCAAX,EAA4C;AACxDC,UAAAA,OAAO,EAAE;AACLC,YAAAA,aAAa,EAAE,YAAYX;AADtB;AAD+C,SAA5C,CAAhB;;AAKA,YAAIQ,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB;AACpBC,UAAAA,OAAO,CAACC,GAAR,CAAYN,GAAG,CAACH,IAAJ,CAASJ,QAArB;AACA,cAAIc,EAAE,GAAG,EAAT;AACA,cAAIC,EAAE,GAAC,EAAP;AACA,gBAAMC,OAAO,CAACC,GAAR,CAAYV,GAAG,CAACH,IAAJ,CAASJ,QAAT,CAAkBkB,GAAlB,CAAsB,OAAOC,CAAP,EAAUC,CAAV,KAAgB;AACpD,gBAAIb,GAAG,GAAG,MAAMb,KAAK,CAACc,GAAN,CAAW,kCAAiCW,CAAC,CAACE,SAAU,EAAxD,CAAhB;;AACA,gBAAId,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB;AACpB,kBAAIJ,GAAG,CAACH,IAAJ,CAASkB,OAAT,CAAiBC,KAAjB,KAA2B3B,IAA/B,EAAqC;AACjCkB,gBAAAA,EAAE,CAACK,CAAC,CAACE,SAAH,CAAF,GAAkBd,GAAG,CAACH,IAAJ,CAASkB,OAA3B;AACAP,gBAAAA,EAAE,CAACS,IAAH,CAAQL,CAAR;AACH;AACJ;AACJ,WARiB,CAAZ,CAAN;AASAd,UAAAA,OAAO,CAAC,EAAC,GAAGS;AAAJ,WAAD,CAAP;AACAb,UAAAA,WAAW,CAAC,CAAC,GAAGc,EAAJ,CAAD,CAAX;AACH;AAEJ,OAvBD,CAuBE,OAAOI,CAAP,EAAU;AAAA;;AACRP,QAAAA,OAAO,CAACa,KAAR,CAAcN,CAAd;AACAO,QAAAA,KAAK,CAACP,CAAD,aAACA,CAAD,sCAACA,CAAC,CAAEQ,QAAJ,oEAAC,YAAavB,IAAd,qDAAC,iBAAmBqB,KAApB,CAAL;AACH;AACJ,KA5BD;;AA6BAnB,IAAAA,EAAE;AACL,GA/BQ,EA+BN,CAACJ,YAAD,CA/BM,CAAT;;AAiCA,QAAM0B,YAAY,GAAG,YAAY;AAC7B,QAAI;AACA,UAAIrB,GAAG,GAAG,MAAMb,KAAK,CAACmC,GAAN,CAAW,yCAAwCC,SAAU,EAA7D,CAAhB;;AACA,UAAIvB,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB,CACpB;AACH;AACJ,KALD,CAKE,OAAOQ,CAAP,EAAU;AACRP,MAAAA,OAAO,CAACC,GAAR,CAAYM,CAAZ;AACAO,MAAAA,KAAK,CAACP,CAAC,CAACQ,QAAF,CAAWvB,IAAX,CAAgBqB,KAAjB,CAAL;AACH;AACJ,GAVD;;AAYA,QAAMM,aAAa,GAAG,YAAY;AAC9B,QAAI;AACA,UAAIxB,GAAG,GAAG,MAAMb,KAAK,CAACmC,GAAN,CAAW,0CAAyCC,SAAU,EAA9D,CAAhB;;AACA,UAAIvB,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB,CACpB;AACH;AACJ,KALD,CAKE,OAAOQ,CAAP,EAAU;AACRP,MAAAA,OAAO,CAACC,GAAR,CAAYM,CAAZ;AACAO,MAAAA,KAAK,CAACP,CAAC,CAACQ,QAAF,CAAWvB,IAAX,CAAgBqB,KAAjB,CAAL;AACH;AACJ,GAVD;;AAYA,QAAMO,YAAY,GAAG,YAAY;AAC7B,QAAI;AACA,UAAIzB,GAAG,GAAG,MAAMb,KAAK,CAACuC,MAAN,CAAc,kCAAiCH,SAAU,EAAzD,CAAhB;;AACA,UAAIvB,GAAG,CAACI,MAAJ,KAAe,GAAnB,EAAwB,CACpB;AACH;AACJ,KALD,CAKE,OAAOQ,CAAP,EAAU;AACRP,MAAAA,OAAO,CAACC,GAAR,CAAYM,CAAZ;AACAO,MAAAA,KAAK,CAACP,CAAC,CAACQ,QAAF,CAAWvB,IAAX,CAAgBqB,KAAjB,CAAL;AACH;AACJ,GAVD;;AAYA,sBAEI;AAAK,IAAA,KAAK,EAAE;AAAES,MAAAA,SAAS,EAAE;AAAb,KAAZ;AAAA,cACKC,MAAM,CAACC,GAAP,CAAWhC,IAAX,EAAiBc,GAAjB,CAAqB,CAACC,CAAD,EAAIC,CAAJ,KAAU;AAC5B,0BAAQ,QAAC,KAAD;AAAe,QAAA,OAAO,EAAED,CAAxB;AAA2B,QAAA,IAAI,EAAEf;AAAjC,SAAYgB,CAAZ;AAAA;AAAA;AAAA;AAAA,cAAR;AACH,KAFA;AADL;AAAA;AAAA;AAAA;AAAA,UAFJ;AASH;;GArFQzB,S;;KAAAA,S;AAuFT,eAAeA,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport BCard from '../components/BCard'\r\nimport axios from 'axios';\r\n\r\nfunction MyBooking() {\r\n    const name = localStorage.getItem('name')\r\n    const token = localStorage.getItem('token');\r\n    const [bookings, setbookings] = useState([]);\r\n    const [fetchTrigger, setfetchTrigger] = useState(0);\r\n    const [data, setdata] = useState({});\r\n\r\n    useEffect(() => {\r\n        const fn = async () => {\r\n            try {\r\n                let res = await axios.get(`http://localhost:5005/bookings`, {\r\n                    headers: {\r\n                        authorization: 'Bearer ' + token\r\n                    }\r\n                })\r\n                if (res.status === 200) {\r\n                    console.log(res.data.bookings);\r\n                    let dd = {}\r\n                    let ll=[]\r\n                    await Promise.all(res.data.bookings.map(async (e, i) => {\r\n                        let res = await axios.get(`http://localhost:5005/listings/${e.listingId}`);\r\n                        if (res.status === 200) {\r\n                            if (res.data.listing.owner === name) {\r\n                                dd[e.listingId] = res.data.listing;\r\n                                ll.push(e);\r\n                            }\r\n                        }\r\n                    }));\r\n                    setdata({...dd})\r\n                    setbookings([...ll]);\r\n                }\r\n\r\n            } catch (e) {\r\n                console.error(e);\r\n                alert(e?.response?.data?.error);\r\n            }\r\n        }\r\n        fn();\r\n    }, [fetchTrigger])\r\n\r\n    const handleAccept = async () => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/accept/${bookingId}`);\r\n            if (res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    const handleDecline = async () => {\r\n        try {\r\n            let res = await axios.put(`http://localhost:5005/bookings/decline/${bookingId}`);\r\n            if (res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    const handleDelete = async () => {\r\n        try {\r\n            let res = await axios.delete(`http://localhost:5005/bookings/${bookingId}`);\r\n            if (res.status === 200) {\r\n                // setfetchTrigger(fetchTrigger+1);\r\n            }\r\n        } catch (e) {\r\n            console.log(e);\r\n            alert(e.response.data.error);\r\n        }\r\n    }\r\n\r\n    return (\r\n\r\n        <div style={{ marginTop: \"100px\" }}>\r\n            {Object.key(data).map((e, i) => {\r\n                return (<BCard key={i} booking={e} data={data} />)\r\n            })}\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default MyBooking\r\n"]},"metadata":{},"sourceType":"module"}